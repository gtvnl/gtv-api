<html>
  <head>
    <link rel="stylesheet" type="text/css" href="/api/css/c3.min.css">
  </head>
  <body>
    <div id="chart"></div>

    <script src="/api/js/d3.v3.min.js" charset="utf-8"></script>
    <script src="/api/js/c3.min.js"></script>
    <script src="/api/js/jquery-2.1.4.js"></script>
    <script>

    var logs = [];
    var dates = ["Dates"];
    var values = ["Values"];
    var descriptions = ["Descriptions"];
    var sensors = ["Sensors"];

    var settings = {
      "async": true,
      "crossDomain": true,
      "url": "http://192.168.10.158/api/logs",
      "method": "GET",
      "headers": {
        "content-type": "application/json",
        "authorization": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxLCJleHAiOjE0Nzk5ODg3OTJ9.NqphOOMRpr9VL8pqJPo7RcMcvuvxBFzxbaHTwk5oCh0"
      }
    }

    $.ajax(settings).done(function (response) {
      logs = response;

      logs.forEach(function(item) {

        if (item.value != undefined) {
          values.push(item.value);
          dates.push(item.updated_at);
          descriptions.push(item.description);
          sensors.push(item.sensor);
        }
      });


      var chart = c3.generate({
        bindto: '#chart',
        data: {
          x : 'Sensors',
          xFormat : '%Y-%m-%dT%H:%M:%S.%LZ',
          columns: [
		sensors,
		values,
		dates
          ],
          zoom: {
            enabled: true
          }
        },

        axis : {
          x : {
            type : 'timeseries',
            tick : {
              format : "%c" // https://github.com/mbostock/d3/wiki/Time-Formatting#wiki-format
            }
          }
        }
      });

    });


    </script>
&copy; 2016 - GTV
  </body>
</html>
